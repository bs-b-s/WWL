## 💾 memory 살펴보기

프로세스와 스레드의 차이를 쉽게 이해하기 위해서 컴퓨터의 메모리가 어떻게 생겨먹었는지 아는 게 좋다.

컴퓨터의 메모리에는 크게 `main memory`(주기억장치)와 `sub memory`(보조기억장치)가 있다.
> 이 두 개만 알아도 돼서 많이 생략했으니 자세히 알고 싶으면 검색하자!

![](https://velog.velcdn.com/images/gimhanul/post/e9082404-e491-4d1a-bbb5-f243041fc121/image.png)

### (1) Main Memory

Main Memory는, 프로그램이 진짜 실행되는 곳이다. 예시로는 RAM, ROM 등이 있다.

### (2) Sub Memory

Sub Memory는, 다운받은 프로그램이 저장되는 곳이다. 예시로는 하드 디스크, SSD 등이 있다.


<br>

## 📥 당신은 카톡을 다운받았다

당신은 pc에 카톡을 다운받았다. 카톡을 설치하면, 설치 파일이 pc에 설치된다. 이때 이 파일은, sub memory에 저장된다. 설치 파일은 그저 카톡을 실행했을 때 어떻게 동작할건지 정의되어 있는 코드 덩어리로, 이를 **프로그램**이라고 한다.
![](https://velog.velcdn.com/images/gimhanul/post/5da7f6ab-28ba-4b58-a025-fe58c1de2851/image.png)


<br>

## 👆 Click! 실행해보자

이제 카톡을 실행했다. 카톡을 클릭해서 실행하는 순간 sub memory에 저장되어 있는 카톡 프로그램 파일이 main memory로 올라간다. 실행되는 데 필요한 독립적인 메모리 공간과, 기타 다른 자원들을 OS로부터 할당받는다. 이렇게 main memory로 올라간 _실행 중인 프로그램_을 **프로세스**라고 한다.

![](https://velog.velcdn.com/images/gimhanul/post/8783b87a-01cb-4e8b-96a9-58392f4b54e3/image.png)


### 독립적인 메모리 공간이요?

독립적인 메모리 공간을 할당한다는 말이 무슨 말일까?
사용자는 보통 프로세스를 여러 개 동시에 사용한다. 그러니까, 컴퓨터에 카톡도 켜놓고 크롬도 켜놓고, 인텔리제이도 켜놓고, 피그마도 켜놓고... 다 켜놓는다.

하지만 모든 프로세스가 메모리를 공유해서 사용하게 하면, 문제가 있다. (변수가 겹친다든지...) 그래서 다음과 같이 프로세스 별로 독립된 메모리 공간을 할당하고 서로 접근하지 못하게 한다.
![](https://miro.medium.com/max/1400/0*jvlxE7iwWWLvzxgo.png)

<br>

## ✉️ 타닥... 타닥... 여보세요?...

당신은 친구랑 보2스톡(이하 보톡)을 하며 동생한테 불 좀 끄러 오라고 카톡을 보낸다.
이것이 가능한 이유가 바로 **스레드**이다.

### 엥? 당연히 가능한 거 아니냐고?
그것은 아닙니다. 사실 프로세스를 까보면 다음과 같이 스레드가 나온다.
그리고 스레드는 프로세스 내에서 실행되는 흐름의 단위를 말한다.
이게 뭔말이냐고? 아직은 무슨 말인지 모르겠다. 그러니까 그냥 **작업하는 애** 정도로 해두자.

![](https://miro.medium.com/max/1400/0*39Jqwl1DcgCaTEGr.png)

그림에서도 보이듯이, 스레드는 프로세스의 독립된 메모리 중 _스택 영역만 독립_ 해서 가지고 있고, 이외의 코드 영역, 데이터 영역, 힙 영역은 공유하여 사용하며, 프로세스는 한 개 이상의 스레드를 가진다.

> 메모리를 공유하기 때문에 동기화, 데드락 등의 문제가 발생 할 수 있다.

### 그럼 보톡하면서 카톡하면 작업이 두 개네요?

맞다. 당신은 카톡이라는 _하나의 프로세스_에서 보톡을 하면서, 카톡도 보내고 있으니까 _두 개의 작업(=스레드)_ 을 하고 있는 것이다. 이를 **멀티 스레딩**이라고 한다.

그리고 또한 이것은, 스레드를 사용하는 이유라고 할 수 있다.
멀티 스레딩을 하지 않고 단일 스레드로 쭉 간다면, 보톡을 끊어야 카톡을 보낼 수 있을 것이다.

<br>

## 🌕 하암 이제 자야지

동생이 불도 꺼줬고... 이제 자야겠다. 카톡을 껐다.
그럼 다시 카톡 프로세스는 sub memory로 돌아가며 종료된다.

![](https://velog.velcdn.com/images/gimhanul/post/5da7f6ab-28ba-4b58-a025-fe58c1de2851/image.png)

그럼 스레드들은요? 걔네들은 프로세스와 _매우 밀접하다_.
따라서, **프로세스가 종료됨에 따라 스레드들도 강제종료**된다.
~~이 글도 이제 강제종료~~